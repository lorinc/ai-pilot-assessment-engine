============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- /home/lorinc/CascadeProjects/ai-pilot-assessment-engine/venv/bin/python
cachedir: .pytest_cache
rootdir: /home/lorinc/CascadeProjects/ai-pilot-assessment-engine
configfile: pytest.ini
plugins: asyncio-1.2.0, langsmith-0.4.41, anyio-4.11.0, mock-3.15.1, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 26 items

tests/patterns/test_trigger_detector.py::TestTriggerDetectorInitialization::test_initialization PASSED [  3%]
tests/patterns/test_trigger_detector.py::TestTriggerDetectorInitialization::test_initialization_with_triggers PASSED [  7%]
tests/patterns/test_trigger_detector.py::TestUserExplicitTriggers::test_detect_navigation_query PASSED [ 11%]
tests/patterns/test_trigger_detector.py::TestUserExplicitTriggers::test_detect_help_request PASSED [ 15%]
tests/patterns/test_trigger_detector.py::TestUserExplicitTriggers::test_detect_review_request PASSED [ 19%]
tests/patterns/test_trigger_detector.py::TestUserExplicitTriggers::test_no_trigger_on_normal_response PASSED [ 23%]
tests/patterns/test_trigger_detector.py::TestUserImplicitTriggers::test_detect_confusion PASSED [ 26%]
tests/patterns/test_trigger_detector.py::TestUserImplicitTriggers::test_detect_contradiction PASSED [ 30%]
tests/patterns/test_trigger_detector.py::TestUserImplicitTriggers::test_detect_scope_ambiguity PASSED [ 34%]
tests/patterns/test_trigger_detector.py::TestSystemProactiveTriggers::test_detect_natural_extraction_opportunity PASSED [ 38%]
tests/patterns/test_trigger_detector.py::TestSystemProactiveTriggers::test_detect_education_opportunity PASSED [ 42%]
tests/patterns/test_trigger_detector.py::TestSystemProactiveTriggers::test_detect_recommendation_opportunity PASSED [ 46%]
tests/patterns/test_trigger_detector.py::TestSystemReactiveTriggers::test_detect_first_message PASSED [ 50%]
tests/patterns/test_trigger_detector.py::TestSystemReactiveTriggers::test_detect_milestone_reached PASSED [ 53%]
tests/patterns/test_trigger_detector.py::TestSystemReactiveTriggers::test_detect_high_frustration PASSED [ 57%]
tests/patterns/test_trigger_detector.py::TestTriggerPriority::test_multiple_triggers_sorted_by_priority PASSED [ 61%]
tests/patterns/test_trigger_detector.py::TestKeywordMatching::test_match_navigation_keywords PASSED [ 65%]
tests/patterns/test_trigger_detector.py::TestKeywordMatching::test_match_confusion_keywords PASSED [ 69%]
tests/patterns/test_trigger_detector.py::TestKeywordMatching::test_no_match_on_unrelated_message PASSED [ 73%]
tests/patterns/test_trigger_detector.py::TestContextAwareness::test_trigger_depends_on_knowledge_state PASSED [ 76%]
tests/patterns/test_trigger_detector.py::TestProfanityAsEmotionalMultiplier::test_extreme_pain_signal PASSED [ 80%]
tests/patterns/test_trigger_detector.py::TestProfanityAsEmotionalMultiplier::test_extreme_frustration PASSED [ 84%]
tests/patterns/test_trigger_detector.py::TestProfanityAsEmotionalMultiplier::test_extreme_satisfaction PASSED [ 88%]
tests/patterns/test_trigger_detector.py::TestProfanityAsEmotionalMultiplier::test_childish_behavior PASSED [ 92%]
tests/patterns/test_trigger_detector.py::TestProfanityAsEmotionalMultiplier::test_profanity_escalates_priority PASSED [ 96%]
tests/patterns/test_trigger_detector.py::TestProfanityAsEmotionalMultiplier::test_normal_frustration_without_profanity PASSED [100%]
ERROR: Coverage failure: total of 8 is less than fail-under=80


================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.3-final-0 ________________

Name                                            Stmts   Miss  Cover   Missing
-----------------------------------------------------------------------------
src/__init__.py                                     0      0   100%
src/app.py                                        161    161     0%   3-303
src/config/__init__.py                              0      0   100%
src/config/settings.py                             24     24     0%   3-54
src/core/__init__.py                                0      0   100%
src/core/firebase_client.py                       233    233     0%   3-568
src/core/graph_manager.py                         241    241     0%   3-624
src/core/llm_client.py                             90     90     0%   3-300
src/core/session_manager.py                        82     82     0%   3-197
src/engines/__init__.py                             0      0   100%
src/engines/assessment.py                         103    103     0%   3-431
src/engines/bottleneck.py                         113    113     0%   3-362
src/engines/discovery.py                          175    175     0%   3-405
src/orchestrator/__init__.py                        0      0   100%
src/orchestrator/conversation_orchestrator.py     126    126     0%   3-408
src/patterns/__init__.py                            0      0   100%
src/patterns/knowledge_tracker.py                  68     38    44%   171, 184-209, 218, 232, 250-261, 273-288, 300-302
src/patterns/models.py                             89     89     0%   7-217
src/patterns/pattern_engine.py                    111    111     0%   16-361
src/patterns/pattern_loader.py                    108    108     0%   7-246
src/patterns/pattern_selector.py                  123    123     0%   11-350
src/patterns/response_composer.py                  55     55     0%   10-229
src/patterns/situational_awareness.py              49     49     0%   16-173
src/patterns/trigger_detector.py                  160     25    84%   247, 301, 310, 404, 520-542, 553-555, 578
src/utils/__init__.py                               0      0   100%
src/utils/logger.py                                39     39     0%   3-113
-----------------------------------------------------------------------------
TOTAL                                            2150   1985     8%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 80% not reached. Total coverage: 7.67%
============================== 26 passed in 0.44s ==============================
